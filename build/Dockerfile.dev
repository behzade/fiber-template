ARG DOCKER_REGISTRY=docker.io
ARG GO_VERSION=1.21

FROM ${DOCKER_REGISTRY}/golang:${GO_VERSION}-bullseye

WORKDIR /app

RUN go install github.com/bokwoon95/wgo@latest
RUN go install entgo.io/ent/cmd/ent@latest

COPY ./go.mod ./go.sum ./

ENV GOPROXY=https://goproxy.cn

CMD ["wgo", "run", "./cmd/server/server.go"]
